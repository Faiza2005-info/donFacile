{% extends 'base.html' %}
{% block content %}
<div style="max-width: 700px; margin: auto;" class="fade-in">
    <h2 style="text-align: center; color: var(--vert-fonce); margin-bottom: 30px;">Détail du don</h2>

    {% if donation %}
        {% if donation[5] %}
            <div style="text-align: center;">
                <img src="{{ url_for('static', filename='uploads/' ~ donation[5]) }}"
                     alt="Image du don"
                     style="max-width: 100%; border-radius: 10px; margin-bottom: 20px;">
            </div>
        {% endif %}

        <div style="background: var(--blanc); padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <h3 style="color: var(--vert-fonce);">{{ donation[0] }}</h3>
            <p><strong>📂 Catégorie :</strong> {{ donation[2] }}</p>
            <p><strong>📝 Description :</strong><br>{{ donation[1] }}</p>
            <p><strong>📍 Localisation :</strong> {{ donation[3] }}</p>
            <p><strong>🕒 Publié le :</strong> {{ donation[4] }}</p>

            {% if session.get('user_id') %}
                {% if demande_acceptee %}
                    <p style="color: gray; font-style: italic;">Ce don a déjà été attribué.</p>
                {% else %}
                    <form method="POST" action="{{ url_for('request_donation', donation_id=donation_id) }}" style="margin-top: 20px;">
                        <button type="submit" class="btn-custom">📩 Demander ce don</button>
                    </form>

                    <p style="margin-top: 15px;">
                        <a href="{{ url_for('messages', donation_id=donation_id, receiver_id=donateur_id) }}"
                           style="color: var(--vert-moyen); text-decoration: underline;">
                            💬 Discuter avec le donateur
                        </a>
                    </p>
                {% endif %}
            {% else %}
                <p><a href="{{ url_for('login') }}" style="color: var(--vert-moyen); text-decoration: underline;">Connectez-vous</a> pour faire une demande.</p>
            {% endif %}
        </div>
    {% else %}
        <p style="text-align: center;">❌ Ce don n'existe pas.</p>
    {% endif %}
</div>
{% endblock %}
